(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47361,       1321]
NotebookOptionsPosition[     46367,       1299]
NotebookOutlinePosition[     46822,       1317]
CellTagsIndexPosition[     46779,       1314]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"L3qubitToR9spin", "=", 
   RowBox[{"<<", "L3qubitToR9spin"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineorder", "=", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "1", ",", "2", ",", "6", ",", "4", ",", "5", ",", "9", ",", "7",
      ",", "8"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.935636164609124*^9, 3.935636204034638*^9}, {
  3.9356362574526277`*^9, 3.9356372695259156`*^9}, {3.9356376335000734`*^9, 
  3.935638132599061*^9}, {3.9356382687849417`*^9, 3.935638423717655*^9}, {
  3.9356384639743958`*^9, 3.9356385864906187`*^9}, {3.9356386829790154`*^9, 
  3.935638717808512*^9}, {3.9356387504404683`*^9, 3.9356387568895698`*^9}, {
  3.935642713484269*^9, 3.9356427443192563`*^9}, {3.9356428483663416`*^9, 
  3.935642848874725*^9}, {3.9356428820400143`*^9, 3.9356428956853046`*^9}, {
  3.95432362486977*^9, 3.9543236292045927`*^9}, {3.961140099342907*^9, 
  3.9611401004481463`*^9}},ExpressionUUID->"95635df4-1c2a-4cad-aa09-\
46b82511d640"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exchangespin1", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin12", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H12", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"H12", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H12", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin23", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H23", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H23", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H23", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin34", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H34", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H34", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H34", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin45", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H45", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H45", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H45", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin56", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H56", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H56", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H56", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin67", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H67", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H67", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H67", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin78", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H78", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H78", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"H78", "-", 
       RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin1", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exchangespin2", "=", "9"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin1", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spin2", "=", 
   RowBox[{"lineorder", "[", 
    RowBox[{"[", "exchangespin2", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hspin", "=", 
   RowBox[{"IdentityMatrix", "[", "512", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin1", "]"}], "]"}], "!=", 
       RowBox[{
        RowBox[{"IntegerDigits", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], "[", 
        RowBox[{"[", "spin2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "i"}], "]"}], "]"}], "=", 
        RowBox[{"-", "1"}]}], ";", 
       RowBox[{
        RowBox[{"Hspin", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"FromDigits", "[", 
             RowBox[{
              RowBox[{"Permute", "[", 
               RowBox[{
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "2", ",", "9"}], "]"}], ",", 
                RowBox[{"Cycles", "[", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"spin1", ",", "spin2"}], "}"}], "}"}], "]"}]}], 
               "]"}], ",", "2"}], "]"}], "+", "1"}]}], "]"}], "]"}], "=", 
        "2"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "512"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Hspin89", "=", 
   RowBox[{"Hspin", "/", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H89", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"L3qubitToR9spin", ".", "Hspin", ".", 
     RowBox[{"Transpose", "[", "L3qubitToR9spin", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H89", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"H89", "-", 
      RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ")"}], "/", "4"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.935636164609124*^9, 3.935636204034638*^9}, {
  3.9356362574526277`*^9, 3.9356372695259156`*^9}, {3.9356376335000734`*^9, 
  3.935638132599061*^9}, {3.9356382687849417`*^9, 3.935638423717655*^9}, {
  3.9356384639743958`*^9, 3.9356385864906187`*^9}, {3.9356386829790154`*^9, 
  3.935638717808512*^9}, {3.9356387504404683`*^9, 3.9356387568895698`*^9}, {
  3.935642713484269*^9, 3.9356427462913074`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"023d1c15-8417-4d39-9c6c-9295fca0851d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"ArcCos", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"2", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], "3"], "-", "1"}], "]"}], "\[Pi]"],
     "-", "1"}]}], ";", 
  RowBox[{"p2", "=", 
   FractionBox[
    RowBox[{"ArcSin", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"Sqrt", "[", "3", "]"}]}], "-", "1"}], "3"], " ", "]"}], 
    "\[Pi]"]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"R12", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["1", "2"], " ", "\[Pi]", " ", "H34"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["3", "2"], " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H34"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H56"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["1", "2"], " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["3", "2"], " ", "\[Pi]", " ", "H34"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"CNOT12", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "p1", " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "p2", " ", "\[Pi]", " ", "H56"}], "]"}], ".", 
     "R12", ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H23"}], "]"}], ".", "R12", 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H23"}], "]"}], ".", "R12", 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "p2"}], ")"}], " ", "\[Pi]", " ", "H56"}], "]"}], 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "p1"}], ")"}], " ", "\[Pi]", " ", "H45"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"R23", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["1", "2"], " ", "\[Pi]", " ", "H67"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["3", "2"], " ", "\[Pi]", " ", "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H67"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H89"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["1", "2"], " ", "\[Pi]", " ", "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["3", "2"], " ", "\[Pi]", " ", "H67"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"CNOT23", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "p1", " ", "\[Pi]", " ", "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "p2", " ", "\[Pi]", " ", "H89"}], "]"}], ".", 
     "R23", ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H56"}], "]"}], ".", "R23", 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       FractionBox["2", "2"], " ", "\[Pi]", " ", "H56"}], "]"}], ".", "R23", 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "p2"}], ")"}], " ", "\[Pi]", " ", "H89"}], "]"}], 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", "p1"}], ")"}], " ", "\[Pi]", " ", "H78"}], "]"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SWAP12", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H34"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H23"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H12"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H34"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H23"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H56"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H34"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"SWAP23", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H67"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H56"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H45"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H67"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H56"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H89"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Pi]", " ", "H67"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"CNOT13", "=", 
   RowBox[{"SWAP23", ".", "CNOT12", ".", "SWAP23"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"ArcCos", "[", 
      FractionBox[
       RowBox[{"2", "-", 
        SqrtBox["2"], "+", 
        SqrtBox[
         RowBox[{"70", "+", 
          RowBox[{"36", " ", 
           SqrtBox["2"]}]}]]}], "12"], "]"}], "\[Pi]"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Phi]", "1"], "=", 
   FractionBox[
    RowBox[{"ArcCos", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SqrtBox["2"], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        SqrtBox["2"]}], 
       SqrtBox["3"]]}], "]"}], "\[Pi]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Phi]", "2"], "=", 
   FractionBox[
    RowBox[{"ArcCos", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SqrtBox["2"], "+", 
       SqrtBox["6"]}], "3"], "]"}], "\[Pi]"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H3Gate", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Phi]", "1"], "-", "1"}], ")"}], "\[Pi]", " ", 
       "H78"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Phi]", "2"]}], ")"}], "\[Pi]", " ", "H89"}], "]"}], 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["\[Phi]", "2"]}], ")"}], "\[Pi]", " ", "H78"}], "]"}], 
     ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         SubscriptBox["\[Phi]", "1"]}], ")"}], "\[Pi]", " ", "H89"}], "]"}]}],
     "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"T1Gate", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H12"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["5", "4"], "-", "\[Theta]"}], ")"}], "\[Pi]", " ", 
       "H23"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H12"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Theta]"}], ")"}], "\[Pi]", " ", "H23"}], "]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2Gate", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H45"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["5", "4"], "-", "\[Theta]"}], ")"}], "\[Pi]", " ", 
       "H56"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H45"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Theta]"}], ")"}], "\[Pi]", " ", "H56"}], "]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T3Gate", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H78"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["5", "4"], "-", "\[Theta]"}], ")"}], "\[Pi]", " ", 
       "H89"}], "]"}], ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Theta]", " ", "\[Pi]", " ", "H78"}], "]"}],
      ".", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Theta]"}], ")"}], "\[Pi]", " ", "H89"}], "]"}]}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CCNOT", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"H3Gate", ".", "CNOT23", ".", 
     RowBox[{"ConjugateTranspose", "[", "T3Gate", "]"}], ".", "CNOT13", ".", 
     "T3Gate", ".", "CNOT23", ".", 
     RowBox[{"ConjugateTranspose", "[", "T3Gate", "]"}], ".", "CNOT13", ".", 
     "T2Gate", ".", "T3Gate", ".", "CNOT12", ".", "H3Gate", ".", "T1Gate", 
     ".", 
     RowBox[{"ConjugateTranspose", "[", "T2Gate", "]"}], ".", "CNOT12"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.935636164609124*^9, 3.935636204034638*^9}, {
  3.9356362574526277`*^9, 3.9356372695259156`*^9}, {3.9356376335000734`*^9, 
  3.935638132599061*^9}, {3.9356382687849417`*^9, 3.935638423717655*^9}, {
  3.9356384639743958`*^9, 3.9356385864906187`*^9}, {3.9356386829790154`*^9, 
  3.935638717808512*^9}, {3.9356387504404683`*^9, 3.9356387568895698`*^9}, {
  3.935642713484269*^9, 3.9356427238891144`*^9}, {3.93564302313732*^9, 
  3.9356430313093257`*^9}, {3.9357851732458067`*^9, 3.935785235429165*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"6494f07c-d5f7-41e2-896d-51505aeb0a2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToffoliGate24", "=", 
   RowBox[{"BlockDiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CCNOT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "8"}], ",", 
         RowBox[{"1", ";;", "8"}]}], "]"}], "]"}], ",", 
      RowBox[{"CCNOT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"11", ";;", "18"}], ",", 
         RowBox[{"11", ";;", "18"}]}], "]"}], "]"}], ",", 
      RowBox[{"CCNOT", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"43", ";;", "50"}], ",", 
         RowBox[{"43", ";;", "50"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"ToffoliGate24", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.935784793163782*^9, 3.9357849014387074`*^9}, 
   3.9357849417947407`*^9, {3.9357849718551073`*^9, 3.9357850315674057`*^9}, {
   3.9357850773117523`*^9, 3.935785124145235*^9}, {3.935785473588441*^9, 
   3.935785476896534*^9}, 
   3.961140234813989*^9},ExpressionUUID->"82406b16-451a-4122-ab1a-\
3f5c20a782d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NTimeStep", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J23", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.361356"}], ",", "0", ",", "0.474996", ",", "0", ",", 
     RowBox[{"-", "0.921766"}], ",", "0", ",", "0", ",", "0", ",", "0.23616", 
     ",", "0", ",", "0.445978", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0.400511", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0.780178", ",", "0", ",", 
     RowBox[{"-", "0.585912"}], ",", "0", ",", "0.768569", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0.610313", ",", "0", ",", "0.6718", ",", "0", 
     ",", "0.669013", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.475713"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J34", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.46694", ",", "0", ",", "0.463992", ",", "0", ",", 
     RowBox[{"-", "0.647173"}], ",", "0", ",", "0.289479", ",", "0", ",", 
     RowBox[{"-", "0.517465"}], ",", "0", ",", "0.757532", ",", "0", ",", "0",
      ",", "0", ",", 
     RowBox[{"-", "0.76173"}], ",", "0", ",", 
     RowBox[{"-", "0.490934"}], ",", "0", ",", 
     RowBox[{"-", "0.562063"}], ",", "0", ",", "0.448977", ",", "0", ",", 
     RowBox[{"-", "0.279016"}], ",", "0", ",", 
     RowBox[{"-", "1.07795"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0.51052", ",", "0", ",", 
     RowBox[{"-", "0.538592"}], ",", "0", ",", "0.586782", ",", "0", ",", "0",
      ",", "0", ",", 
     RowBox[{"-", "1.01647"}], ",", "0", ",", "0.823515", ",", "0", ",", 
     RowBox[{"-", "0.556544"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J45", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "0.6808"}], ",", "0", ",", 
     RowBox[{"-", "0.352727"}], ",", "0", ",", 
     RowBox[{"-", "0.783947"}], ",", "0", ",", 
     RowBox[{"-", "1.03236"}], ",", "0", ",", 
     RowBox[{"-", "0.591699"}], ",", "0", ",", 
     RowBox[{"-", "0.580782"}], ",", "0", ",", 
     RowBox[{"-", "0.547022"}], ",", "0", ",", "0", ",", "0", ",", "0.613639",
      ",", "0", ",", "0.708219", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.692437"}], ",", "0", ",", 
     RowBox[{"-", "0.0895998"}], ",", "0", ",", 
     RowBox[{"-", "0.648449"}], ",", "0", ",", "0.378554", ",", "0", ",", 
     RowBox[{"-", "1.44203"}], ",", "0", ",", 
     RowBox[{"-", "0.617632"}], ",", "0", ",", "1.31782", ",", "0"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J56", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0.683111", ",", "0", ",", 
     RowBox[{"-", "1.29074"}], ",", "0", ",", "0.463229", ",", "0", ",", 
     RowBox[{"-", "0.341"}], ",", "0", ",", "1.29282", ",", "0", ",", 
     RowBox[{"-", "0.355991"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.754719"}], ",", "0", ",", "0", ",", "0", ",", "0.812474",
      ",", "0", ",", "0", ",", "0", ",", "0.724231", ",", "0", ",", "0", ",", 
     "0", ",", "0.481629", ",", "0", ",", "0.650856", ",", "0", ",", "0", ",",
      "0", ",", 
     RowBox[{"-", "0.649904"}], ",", "0", ",", 
     RowBox[{"-", "0.353683"}], ",", "0", ",", 
     RowBox[{"-", "1.18546"}], ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "0.376096"}], ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J67", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0.561134", ",", "0", ",", 
     RowBox[{"-", "0.240236"}], ",", "0", ",", 
     RowBox[{"-", "1.47277"}], ",", "0", ",", 
     RowBox[{"-", "0.409208"}], ",", "0", ",", 
     RowBox[{"-", "0.313122"}], ",", "0", ",", "0.20101", ",", "0", ",", 
     "1.31895", ",", "0", ",", "1.8308", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1.59216"}], ",", "0", ",", "1.29184", ",", "0", ",", 
     "0.577097", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J78", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", 
     RowBox[{"-", "0.401742"}], ",", "0", ",", 
     RowBox[{"-", "0.49032"}], ",", "0", ",", 
     RowBox[{"-", "0.574828"}], ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1.07902"}], ",", "0", ",", "0.370976", ",", "0", ",", 
     RowBox[{"-", "0.571905"}], ",", "0", ",", 
     RowBox[{"-", "0.647533"}], ",", "0", ",", "1.34169", ",", "0", ",", 
     RowBox[{"-", "0.807275"}], ",", "0", ",", 
     RowBox[{"-", "0.0284115"}], ",", "0", ",", 
     RowBox[{"-", "0.529812"}], ",", "0", ",", "1.46932", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J89", "=", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", 
     RowBox[{"-", "0.985982"}], ",", "0", ",", "0.782226", ",", "0", ",", 
     RowBox[{"-", "0.0251349"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", 
     RowBox[{"-", "1.44753"}], ",", "0", ",", "0.349844", ",", "0", ",", "0", 
     ",", "0", ",", "0.418598", ",", "0", ",", "0", ",", "0", ",", "0.45061", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.935636164609124*^9, 3.935636204034638*^9}, {
  3.9356362574526277`*^9, 3.9356372695259156`*^9}, {3.9356376335000734`*^9, 
  3.935638132599061*^9}, {3.9356382687849417`*^9, 3.935638423717655*^9}, {
  3.9356384639743958`*^9, 3.9356385864906187`*^9}, {3.9356386829790154`*^9, 
  3.935638717808512*^9}, {3.9356387504404683`*^9, 3.9356387568895698`*^9}, {
  3.935642713484269*^9, 3.9356427238891144`*^9}, {3.93564302313732*^9, 
  3.9356430313093257`*^9}, {3.9357851732458067`*^9, 3.9357851774372234`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"4d153b7c-e118-4872-a65d-c54c2a8c3e3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "NTimeStep"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "90"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "90"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", 
     RowBox[{"Chop", "[", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Pi]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"J23", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H23"}], "+", 
          RowBox[{
           RowBox[{"J34", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H34"}], "+", 
          RowBox[{
           RowBox[{"J45", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H45"}], "+", 
          RowBox[{
           RowBox[{"J56", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H56"}], "+", 
          RowBox[{
           RowBox[{"J67", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H67"}], "+", 
          RowBox[{
           RowBox[{"J78", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H78"}], "+", 
          RowBox[{
           RowBox[{"J89", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", "H89"}]}], ")"}]}], "]"}], 
      "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "NTimeStep"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Ufinal", "=", 
   RowBox[{"IdentityMatrix", "[", "90", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Ufinal", "=", 
     RowBox[{
      RowBox[{"U", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", "Ufinal"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "NTimeStep"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.935643787967326*^9, 3.935644030549982*^9}, {
   3.9356440758282967`*^9, 3.9356440779031415`*^9}, {3.935644211654171*^9, 
   3.935644234168481*^9}, {3.9356443202609262`*^9, 3.935644336985965*^9}, {
   3.9356443870510235`*^9, 3.935644496098857*^9}, 3.9356447550006323`*^9, 
   3.9611401782980385`*^9},ExpressionUUID->"34497126-6404-4585-bb62-\
d0365a3d2596"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToffoliGate24search", "=", 
   RowBox[{"BlockDiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ufinal", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "8"}], ",", 
         RowBox[{"1", ";;", "8"}]}], "]"}], "]"}], ",", 
      RowBox[{"Ufinal", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"11", ";;", "18"}], ",", 
         RowBox[{"11", ";;", "18"}]}], "]"}], "]"}], ",", 
      RowBox[{"Ufinal", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"43", ";;", "50"}], ",", 
         RowBox[{"43", ";;", "50"}]}], "]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{"ToffoliGate24search", ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.9543244535016994`*^9, 3.954324547772789*^9}, 
   3.9611402606149497`*^9},ExpressionUUID->"4097fd28-24d7-41de-aa95-\
2f851929ad89"]
},
WindowSize->{1080., 607.5},
WindowMargins->{{-4.875, Automatic}, {Automatic, -4.875}},
Magnification:>0.75 Inherited,
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (2022\:5e746\:670816\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4ff55387-04c8-4f3b-8a8e-34cadfad849f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1005, 19, 36, "Input",ExpressionUUID->"95635df4-1c2a-4cad-aa09-46b82511d640"],
Cell[1566, 41, 21130, 622, 1736, "Input",ExpressionUUID->"023d1c15-8417-4d39-9c6c-9295fca0851d"],
Cell[22699, 665, 12475, 372, 682, "Input",ExpressionUUID->"6494f07c-d5f7-41e2-896d-51505aeb0a2a"],
Cell[35177, 1039, 1051, 28, 59, "Input",ExpressionUUID->"82406b16-451a-4122-ab1a-3f5c20a782d2"],
Cell[36231, 1069, 6781, 129, 221, "Input",ExpressionUUID->"4d153b7c-e118-4872-a65d-c54c2a8c3e3b"],
Cell[43015, 1200, 2354, 66, 112, "Input",ExpressionUUID->"34497126-6404-4585-bb62-d0365a3d2596"],
Cell[45372, 1268, 991, 29, 61, "Input",ExpressionUUID->"4097fd28-24d7-41de-aa95-2f851929ad89"]
}
]
*)

